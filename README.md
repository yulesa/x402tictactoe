# Tic-Tac-Toe x402

A pay-per-play Tic-Tac-Toe game demonstrating x402 payment protocol integration. Players pay 0.01 USDC per game on Base Sepolia.

## Quick Start

### Prerequisites

- Node.js 18+
- A browser wallet (MetaMask, Rabby, etc.)
- Base Sepolia USDC for testing. You can fund your new wallet on most Base Sepolia (Testnet) via the CDP Faucet, select the token (USDC for this demo) and provide the address generated by wallet.

### Installation

```bash
# Install all dependencies
cd server && npm install
cd ../client && npm install
```

### Running

```bash
# Terminal 1 - Start server
cd server && npm run dev

# Terminal 2 - Start client
cd client && npm run dev
```

Open http://localhost:5173 in your browser.

## How It Works

1. **Connect Wallet** - Click "Connect Wallet & Play" to connect your browser wallet
2. **Sign Payment** - Sign a message to authorize the 0.01 USDC payment
3. **Play** - Make moves on the 3x3 grid. You are always playing X, Bot is O
4. **Game Over** - Win, lose, or draw. Pay again to play another game

## Project Structure

```
├── server/                 # Express backend (TypeScript)
│   └── src/
│       ├── index.ts        # Server entry point
│       ├── middleware/
│       │   └── x402.ts     # Payment validation
│       ├── routes/
│       │   ├── session.ts  # Session management
│       │   └── game.ts     # Game moves
│       └── services/
│           ├── sessionStore.ts  # In-memory sessions
│           └── gameEngine.ts    # Bot logic
│
└── client/                 # React frontend (TypeScript)
    └── src/
        ├── App.tsx         # Main component
        ├── main.tsx        # Wagmi setup
        ├── components/
        │   ├── LandingPage.tsx
        │   ├── GameBoard.tsx
        │   └── WalletConnect.tsx
        ├── hooks/
        │   └── useSession.ts
        └── services/
            └── api.ts
```

## API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/session/start` | POST | Start new game (x402 protected) |
| `/api/session/:wallet` | GET | Get session status |
| `/api/game/move` | POST | Make a move |

## Configuration

### Server Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `PORT` | 3001 | Server port |
| `PAYMENT_ADDRESS` | 0x0...0 | Wallet to receive payments |

## Tech Stack

- **Server**: Node.js, Express, TypeScript
- **Client**: React, Vite, TypeScript
- **Wallet**: wagmi, viem
- **Network**: Base Sepolia
- **Payment**: x402 protocol, USDC

## MVP Limitations

- In-memory session storage (no persistence)
- Single server (no horizontal scaling)
- Simplified x402 validation (wallet signature only)
- No refunds for abandoned games

## License

MIT
